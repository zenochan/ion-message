{"version":3,"file":"PP.js","sourceRoot":"","sources":["../../../src/ppmessage/PP.ts"],"names":[],"mappings":"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","sourcesContent":["import {text} from \"@angular/core/src/render3/instructions\";\n\nexport class PPMessage\n{\n\n  public static PP: any = null;\n\n  public static get initialized()\n  {\n    return typeof window[\"PP\"] != \"undefined\";\n  }\n\n  public static ready(): Promise<PPMessage>\n  {\n    return new Promise<any>(resolve => {\n      let loop = (ms: number) => {\n        if (PPMessage.initialized) {\n          this.PP = window['PP'];\n          resolve(PPMessage)\n        } else {\n          setTimeout(() => loop(ms), ms)\n        }\n      };\n      loop(100);\n    })\n  }\n\n  public static update(conf: {\n    app_uuid?: string,\n    ent_user_id?: string,\n    ent_user_name?: string,\n    ent_user_icon?: string,\n    ent_user_mobile?: string,\n    view?: {\n      launcher_is_show?: boolean,\n      launcher_bottom_margin?: string,    //'20px'\n      launcher_right_margin?: string,     //'30px'\n      launch_style?: {\n        mode?: string,                    //'normal',\n        position?: string,                //'right',\n        bottom?: number                   //95\n      }\n    }\n  })\n  {\n    this.ready().then(() => {\n      Object.keys(conf).forEach(key => window['ppSettings'][key] = conf[key])\n      this.PP.update()\n    })\n  }\n\n  public static onShow(): Promise<void>\n  {\n    return this.ready()\n        .then(() => new Promise<void>(ex => this.PP.onShow(() => ex())))\n  }\n\n  public static show()\n  {\n    this.ready().then(() => {\n      if (!this.PP.isOpen()) {\n        this.PP.show();\n        this.resizePP();\n      }\n    })\n  }\n\n  /**\n   * 解决输入法遮挡输入框\n   */\n  public static resizePP()\n  {\n    setTimeout(() => {\n      let pp = document.getElementById(\"pp-conversation\");\n      let textarea = document.getElementById(\"pp-composer-container-textarea\");\n      let content = document.getElementById(\"pp-conversation-content\");\n      if (!!pp) return;\n      textarea.addEventListener(\"focus\", () => {\n        // pp.scrollIntoView(false)\n        setTimeout(() => {\n          content.dataset.height = content.style.height;\n          content.style.height = parseInt(content.style.height.replace(\"px\", \"\")) - 100 + \"px\";\n        }, 100)\n      });\n      textarea.addEventListener(\"blur\", () => {\n        // setTimeout(() => { pp.style.height = window.innerHeight + \"px\"; }, 100);\n        content.style.height = content.dataset.height\n      })\n    }, 3000);\n  }\n}\n"]}